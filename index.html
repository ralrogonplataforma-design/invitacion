<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XV A√±os Sara√≠ Michelle - Invitaci√≥n Interactiva</title>
    <meta property="og:title" content="XV A√±os Sara√≠ Michelle">
    <meta property="og:description" content="Te invito a celebrar mis XV a√±os">
    <meta property="og:image" content="https://ralrogonplataforma-design.github.io/invitacion/preview.jpg">
    <meta property="og:url" content="https://ralrogonplataforma-design.github.io/invitacion/">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Great+Vibes&family=Montserrat:wght@300;400;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
        }

        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }

        .cursive {
            font-family: 'Great Vibes', cursive;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        /* Animaci√≥n del sobre */
        .envelope {
            position: relative;
            width: 350px;
            height: 250px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .envelope:hover {
            transform: scale(1.05);
        }

        .envelope-back {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f5f5dc 0%, #e8e4d0 100%);
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .envelope-front {
            position: absolute;
            width: 0;
            height: 0;
            top: 0;
            left: 0;
            border-left: 175px solid transparent;
            border-right: 175px solid transparent;
            border-bottom: 125px solid #d4cdb8;
            transform-origin: top center;
            transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 3;
        }

        .envelope-top {
            position: absolute;
            width: 0;
            height: 0;
            top: 0;
            left: 0;
            border-left: 175px solid transparent;
            border-right: 175px solid transparent;
            border-top: 125px solid #e8e4d0;
            transform-origin: top center;
            z-index: 2;
            transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .envelope.open .envelope-top {
            transform: rotateX(180deg);
            border-top-color: #c9c0a8;
        }

        .envelope.open .envelope-front {
            transform: rotateX(-180deg);
        }

        .seal {
            position: absolute;
            width: 80px;
            height: 80px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: radial-gradient(circle, #dc2626 0%, #991b1b 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.5);
            z-index: 4;
            transition: all 0.8s ease;
        }

        .envelope.open .seal {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0);
        }

        .letter {
            position: absolute;
            width: 90%;
            height: 85%;
            top: 5%;
            left: 5%;
            background: white;
            border-radius: 5px;
            z-index: 1;
            transition: transform 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .envelope.open .letter {
            transform: translateY(-100%);
        }

        /* Animaci√≥n de escritura */
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink {
            50% { border-color: transparent; }
        }

        .typewriter {
            overflow: hidden;
            white-space: nowrap;
            display: inline-block;
            animation: typing 3s steps(40) forwards;
        }

        .typewriter-container {
            display: inline-block;
        }

        /* Animaci√≥n de fade in */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fadeIn {
            animation: fadeIn 1s ease-out forwards;
        }

        .animate-slideUp {
            animation: slideUp 0.8s ease-out forwards;
        }

        /* Fondo con texto */
        .background-text {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.03;
            font-size: 120px;
            font-weight: 900;
            color: white;
            overflow: hidden;
            pointer-events: none;
        }

        .background-text span {
            position: absolute;
            white-space: nowrap;
        }

        /* Botones elegantes */
        .elegant-button {
            background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(236, 72, 153, 0.4);
        }

        .elegant-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(236, 72, 153, 0.6);
        }

        /* Modal QR */
        .qr-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .qr-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            animation: slideUp 0.4s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .envelope {
                width: 280px;
                height: 200px;
            }

            .envelope-front,
            .envelope-top {
                border-left-width: 140px;
                border-right-width: 140px;
            }

            .envelope-front {
                border-bottom-width: 100px;
            }

            .envelope-top {
                border-top-width: 100px;
            }

            .seal {
                width: 60px;
                height: 60px;
                font-size: 30px;
            }
        }

        /* Flores decorativas */
        .flower-decoration {
            position: absolute;
            opacity: 0.1;
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        .floating {
            animation: float 6s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-pink-50 via-purple-50 to-pink-100 min-h-screen">
    <!-- Texto de fondo animado -->
    <div class="background-text" id="backgroundText"></div>

    <!-- Flores decorativas -->
    <div class="flower-decoration floating text-pink-300 text-8xl" style="top: 10%; left: 5%;">üå∏</div>
    <div class="flower-decoration floating text-purple-300 text-6xl" style="top: 20%; right: 8%; animation-delay: 1s;">ü¶ã</div>
    <div class="flower-decoration floating text-pink-300 text-7xl" style="bottom: 15%; left: 10%; animation-delay: 2s;">üå∫</div>
    <div class="flower-decoration floating text-purple-300 text-9xl" style="bottom: 20%; right: 5%; animation-delay: 1.5s;">üíï</div>

    <div id="app" class="relative z-10"></div>
    <div id="modal-container"></div>

    <script>
        // Estado global
        let state = {
            opened: false,
            showQR: false,
            qrType: null,
            showTicketGenerator: false,
            guestName: '',
            guestNames: [''],
            generatedTickets: [],
            currentSection: 'inicio'
        };

        // Datos del evento
        const eventData = {
            quincea√±era: {
                nombre: "Sara√≠",
                apellido: "Michelle",
                edad: "15",
                fecha: "21 de Marzo, 2025",
                frase: "Llega una edad m√°gica, un d√≠a hermoso, el mundo es un lugar lleno de misterios por descubrir, amistades por conocer, sue√±os por realizar y aventuras por vivir. Disfr√∫talo."
            },
            ceremonia: {
                nombre: "Parroquia Josefina de la Sagrada Familia",
                nombreCompleto: "Parroquia Josefina de la Sagrada Familia De Santa Mar√≠a la Ribera, A.R",
                direccion: "Santa Mar√≠a la Ribera No. 69",
                colonia: "Col. Santa Mar√≠a la Ribera",
                ciudad: "Alcald√≠a Cuauht√©moc C.P. 06400 M√©xico, D.F",
                telefono: "5573144793 / 5576467046",
                hora: "17:00 horas",
                fecha: "21 de Marzo, 2025",
                mapsUrl: "https://maps.google.com/?q=Parroquia+Josefina+de+la+Sagrada+Familia+Santa+Mar√≠a+la+Ribera+69+Cuauht√©moc+CDMX"
            },
            recepcion: {
                nombre: "Colonia San Rafael",
                direccion: "Calle Edison #177",
                referencia: "Casi esquina con Serapio Rend√≥n",
                colonia: "Colonia San Rafael",
                ciudad: "Ciudad de M√©xico",
                hora: "19:00 horas (despu√©s de la ceremonia)",
                mapsUrl: "https://maps.google.com/?q=Calle+Edison+177+Colonia+San+Rafael+CDMX"
            },
            padres: {
                nombres: "Catalina y Ra√∫l"
            },
            timeline: [
                { age: '0-3', title: 'Los Primeros Pasos', desc: 'Descubriendo el mundo con alegr√≠a y asombro', emoji: 'üë∂' },
                { age: '4-7', title: 'A√±os de Magia', desc: 'Curiosidad sin l√≠mites y sue√±os infinitos', emoji: '‚ú®' },
                { age: '8-10', title: 'Crecimiento', desc: 'Nuevas amistades y aventuras escolares', emoji: 'üå±' },
                { age: '11-12', title: 'Cambios', desc: 'Descubriendo qui√©n eres y qui√©n quieres ser', emoji: 'ü¶ã' },
                { age: '13-14', title: 'Adolescencia', desc: 'Fortaleza, pasi√≥n y un coraz√≥n que crece', emoji: 'üí™' },
                { age: '15', title: 'Quince A√±os', desc: '¬°Tu d√≠a especial! El inicio de una nueva etapa', emoji: 'üëë' }
            ]
        };

        // Generar texto de fondo animado (car√°cter a car√°cter como m√°quina de escribir)
        function generateBackgroundText() {
            const texts = ['XV A√ëOS', 'SARA√ç', '15', 'MICHELLE', 'CELEBRACI√ìN'];
            const container = document.getElementById('backgroundText');
            container.innerHTML = '';
            
            texts.forEach((text, index) => {
                const span = document.createElement('span');
                span.style.top = `${Math.random() * 80 + 10}%`;
                span.style.left = `-100%`;
                span.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
                
                let charIndex = 0;
                const writeInterval = setInterval(() => {
                    if (charIndex < text.length) {
                        span.textContent += text.charAt(charIndex);
                        charIndex++;
                    } else {
                        clearInterval(writeInterval);
                    }
                }, 100);
                
                setTimeout(() => {
                    span.style.transition = 'left 5s ease-out';
                    span.style.left = `${Math.random() * 100}%`;
                }, index * 800);
                
                container.appendChild(span);
            });
        }

        // Generar c√≥digo QR
        function generateQRCode(text, elementId) {
            const qr = qrcode(0, 'M');
            qr.addData(text);
            qr.make();
            
            const size = 200;
            const canvas = document.createElement('canvas');
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext('2d');
            
            const moduleCount = qr.getModuleCount();
            const moduleSize = size / moduleCount;
            
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, size, size);
            
            ctx.fillStyle = '#000000';
            for (let row = 0; row < moduleCount; row++) {
                for (let col = 0; col < moduleCount; col++) {
                    if (qr.isDark(row, col)) {
                        ctx.fillRect(col * moduleSize, row * moduleSize, moduleSize, moduleSize);
                    }
                }
            }
            
            document.getElementById(elementId).innerHTML = '';
            document.getElementById(elementId).appendChild(canvas);
        }

        // Funci√≥n de escritura m√°quina de escribir (car√°cter a car√°cter)
        function typeText(elementId, text, speed, callback) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            let index = 0;
            element.innerHTML = '<span class="typing-text"></span><span class="typing-cursor" style="display:inline-block;width:3px;height:1em;background:#ec4899;margin-left:2px;animation:blink 0.7s infinite;vertical-align:middle;"></span>';
            const textSpan = element.querySelector('.typing-text');
            
            function type() {
                if (index < text.length) {
                    textSpan.textContent += text.charAt(index);
                    index++;
                    setTimeout(type, speed);
                } else {
                    const cursor = element.querySelector('.typing-cursor');
                    if (cursor) cursor.remove();
                    if (callback) callback();
                }
            }
            
            type();
        }

        // Abrir sobre
        function openEnvelope() {
            if (!state.opened) {
                document.getElementById('envelope').classList.add('open');
                setTimeout(() => {
                    state.opened = true;
                    state._envelopeRendered = false;
                    render();
                    
                    setTimeout(() => {
                        typeText('frase-magica', eventData.quincea√±era.frase, 20, () => {
                            typeText('invitacion-label', '‚ú¶ Invitaci√≥n Especial ‚ú¶', 80, () => {
                                typeText('padres-nombres', eventData.padres.nombres.toUpperCase(), 60, () => {
                                    typeText('nombre-principal', eventData.quincea√±era.nombre.toUpperCase(), 70, () => {
                                        typeText('apellido-principal', eventData.quincea√±era.apellido.toUpperCase(), 70);
                                    });
                                });
                            });
                        });
                    }, 300);
                }, 1800);
            }
        }

        // Compartir por WhatsApp
        function shareWhatsApp() {
            const message = `¬°Est√°s invitado a mis XV a√±os! üéâüíï

üåü ${eventData.quincea√±era.nombre} ${eventData.quincea√±era.apellido}
üìÖ ${eventData.ceremonia.fecha}
‚õ™ ${eventData.ceremonia.hora}

Ve todos los detalles aqu√≠:
https://ralrogonplataforma-design.github.io/invitacion/`;
            const url = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        function shareOnFacebook() {
            const url = 'https://ralrogonplataforma-design.github.io/invitacion/';
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank', 'width=600,height=400');
        }

        function shareOnTwitter() {
            const url = 'https://ralrogonplataforma-design.github.io/invitacion/';
            const text = `¬°Estoy invitado a los XV a√±os de Sara√≠! üéâüíï ${url}`;
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
        }

        function renderTimeline() {
            return `
                <div class="qr-modal" onclick="if(event.target===this)closeModal()">
                    <div class="qr-content max-w-2xl w-full" style="background:white;">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-3xl font-bold text-pink-600 flex items-center gap-2">üìñ Mi Viaje</h3>
                            <button onclick="closeModal()" class="text-gray-400 hover:text-gray-700 text-3xl">√ó</button>
                        </div>
                        <div style="display:flex;flex-direction:column;gap:12px;">
                            ${eventData.timeline.map(stage => `
                                <div style="position:relative;padding-left:48px;padding-bottom:12px;">
                                    <div style="position:absolute;left:18px;top:0;bottom:0;width:2px;background:linear-gradient(to bottom,#ec4899,#a855f7);"></div>
                                    <div style="position:absolute;left:11px;top:4px;width:16px;height:16px;background:#ec4899;border-radius:50%;border:3px solid white;box-shadow:0 0 0 2px #ec4899;"></div>
                                    <div style="background:linear-gradient(135deg,#fdf2f8,#f5f3ff);border-radius:12px;padding:16px;border:1px solid #fbcfe8;">
                                        <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px;">
                                            <span style="font-size:1.8rem;">${stage.emoji}</span>
                                            <div>
                                                <p style="color:#ec4899;font-weight:bold;font-size:0.8rem;">${stage.age} a√±os</p>
                                                <h4 style="color:#1f2937;font-weight:bold;font-size:1.1rem;">${stage.title}</h4>
                                            </div>
                                        </div>
                                        <p style="color:#6b7280;font-size:0.875rem;padding-left:48px;">${stage.desc}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="closeModal()" 
                                class="w-full mt-6 elegant-button text-white font-bold py-4 rounded-2xl transition">
                            Cerrar
                        </button>
                    </div>
                </div>
            `;
        }

        // Mostrar QR
        function showQR(type) {
            state.showQR = true;
            state.showTimeline = false;
            state.showTicketGenerator = false;
            state.qrType = type;
            render();
        }

        // Cerrar modal
        function closeModal() {
            state.showQR = false;
            state.showTicketGenerator = false;
            state.showTimeline = false;
            state.generatedTickets = [];
            state.guestNames = [''];
            document.getElementById('modal-container').innerHTML = '';
        }

        // Toggle ticket generator
        function toggleTicket() {
            state.showTicketGenerator = true;
            state.showQR = false;
            state.showTimeline = false;
            state.generatedTickets = [];
            state.guestNames = [''];
            render();
        }

        // Toggle timeline
        function toggleTimeline() {
            state.showTimeline = !state.showTimeline;
            state.showQR = false;
            state.showTicketGenerator = false;
            render();
        }

        function addGuestName() {
            state.guestNames.push('');
            document.getElementById('modal-container').innerHTML = renderTicketForm();
        }

        function removeGuestName(index) {
            if (state.guestNames.length > 1) {
                state.guestNames.splice(index, 1);
                document.getElementById('modal-container').innerHTML = renderTicketForm();
            }
        }

        function updateGuestName(index, value) {
            state.guestNames[index] = value;
        }

        function generateTicketNumber() {
            return `XV-${new Date().getFullYear()}-${Math.random().toString(36).substring(2, 8).toUpperCase()}`;
        }

        function generateTickets() {
            const validNames = state.guestNames.filter(name => name.trim() !== '');
            if (validNames.length === 0) {
                alert('Por favor ingresa al menos un nombre');
                return;
            }
            state.generatedTickets = validNames.map(name => ({
                name: name.trim().toUpperCase(),
                number: generateTicketNumber(),
                date: '21 de Marzo',
                year: '2025',
                time: '17:00 hrs',
                location: eventData.ceremonia.nombre,
                address: eventData.ceremonia.direccion,
                city: eventData.ceremonia.ciudad,
                code: Math.random().toString(36).substring(2, 11).toUpperCase()
            }));
            document.getElementById('modal-container').innerHTML = renderTicketForm();
        }

        async function downloadTicketsPDF() {
            const element = document.getElementById('tickets-container');
            const opt = {
                margin: 10,
                filename: 'boletos-xv-sarai.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };
            await html2pdf().set(opt).from(element).save();
        }

        async function downloadTicketsImage() {
            const element = document.getElementById('tickets-container');
            const canvas = await html2canvas(element, { backgroundColor: '#ffffff', scale: 2 });
            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = 'boletos-xv-sarai.png';
            link.click();
        }

        function shareTicketWhatsApp() {
            const url = 'https://ralrogonplataforma-design.github.io/invitacion/';
            const text = `¬°Est√°s invitado a los XV a√±os de Sara√≠! üéâüíï\n\nüåü Sara√≠ Michelle\nüìÖ 21 de Marzo, 2025\n‚õ™ 17:00 horas\n\nVe todos los detalles aqu√≠:\n${url}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        function renderTicketForm() {
            if (state.generatedTickets.length === 0) {
                return `
                    <div style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:1000;" onclick="if(event.target===this)closeModal()">
                        <div style="background:white;padding:30px;border-radius:20px;max-width:90%;max-height:90%;overflow-y:auto;width:450px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;">
                                <h3 style="font-size:1.5rem;font-weight:bold;color:#be185d;">üé´ Generar Boletos</h3>
                                <button onclick="closeModal()" style="font-size:1.5rem;color:#9ca3af;cursor:pointer;">√ó</button>
                            </div>
                            <div style="background:linear-gradient(135deg,#fdf2f8,#f5f3ff);border-radius:12px;padding:20px;border:2px solid #fbcfe8;">
                                <p style="color:#6b7280;margin-bottom:16px;text-align:center;">Ingresa los nombres de tus invitados:</p>
                                <div id="guestInputs" style="display:flex;flex-direction:column;gap:10px;margin-bottom:16px;">
                                    ${state.guestNames.map((name, index) => `
                                        <div style="display:flex;gap:8px;">
                                            <input 
                                                type="text" 
                                                placeholder="Nombre completo ${index + 1}"
                                                value="${name}"
                                                oninput="updateGuestName(${index}, this.value)"
                                                style="flex:1;padding:12px 16px;border-radius:10px;border:2px solid #f9a8d4;font-size:1rem;outline:none;"
                                            />
                                            ${state.guestNames.length > 1 ? `
                                                <button onclick="removeGuestName(${index})" style="padding:12px;background:#dc2626;color:white;border:none;border-radius:10px;cursor:pointer;font-size:1rem;">√ó</button>
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                </div>
                                <button onclick="addGuestName()" style="width:100%;margin-bottom:12px;background:#f3f4f6;border:none;color:#374151;font-weight:bold;padding:12px;border-radius:10px;cursor:pointer;">+ Agregar otro nombre</button>
                                <button onclick="generateTickets()" style="width:100%;background:linear-gradient(135deg,#ec4899,#be185d);border:none;color:white;font-weight:bold;padding:14px;border-radius:12px;font-size:1rem;cursor:pointer;">‚ú® Generar Boletos</button>
                            </div>
                            <button onclick="closeModal()" style="width:100%;margin-top:16px;background:#f3f4f6;border:none;color:#374151;font-weight:bold;padding:14px;border-radius:12px;cursor:pointer;">Cerrar</button>
                        </div>
                    </div>
                `;
            } else {
                return `
                    <div style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:flex;align-items:flex-start;justify-content:center;z-index:1000;overflow-y:auto;padding:20px 0;" onclick="if(event.target===this)closeModal()">
                        <div style="background:white;padding:30px;border-radius:20px;max-width:90%;width:600px;margin:20px;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;">
                                <h3 style="font-size:1.5rem;font-weight:bold;color:#be185d;">üé´ Tus Boletos VIP</h3>
                                <button onclick="closeModal()" style="font-size:1.5rem;color:#9ca3af;cursor:pointer;">√ó</button>
                            </div>
                            <div id="tickets-container" style="display:flex;flex-direction:column;gap:20px;">
                                ${state.generatedTickets.map(ticket => `
                                    <div style="background:linear-gradient(135deg,#7c3aed,#be185d);border-radius:20px;padding:30px;color:white;box-shadow:0 10px 30px rgba(190,24,93,0.3);">
                                        <div style="text-align:center;border-bottom:1px solid rgba(255,255,255,0.3);padding-bottom:20px;margin-bottom:20px;">
                                            <p style="font-size:0.75rem;letter-spacing:0.3em;text-transform:uppercase;opacity:0.8;margin-bottom:8px;">‚ú® XV A√ëOS VIP EXPERIENCE ‚ú®</p>
                                            <h2 style="font-size:2.5rem;font-weight:900;margin-bottom:4px;">SARA√ç</h2>
                                            <p style="opacity:0.7;font-size:0.875rem;">Celebraci√≥n XV A√±os</p>
                                        </div>
                                        <div style="text-align:center;padding:20px;background:rgba(255,255,255,0.1);border-radius:12px;margin-bottom:20px;">
                                            <p style="font-size:0.75rem;opacity:0.7;text-transform:uppercase;letter-spacing:0.1em;margin-bottom:8px;">Invitado VIP</p>
                                            <p style="font-size:2rem;font-weight:900;">${ticket.name}</p>
                                            <p style="margin-top:8px;">‚≠ê ‚≠ê ‚≠ê</p>
                                        </div>
                                        <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;margin-bottom:20px;">
                                            <div style="background:rgba(255,255,255,0.1);border-radius:10px;padding:10px;text-align:center;">
                                                <p style="font-size:0.6rem;opacity:0.7;text-transform:uppercase;margin-bottom:4px;">Boleto #</p>
                                                <p style="font-family:monospace;font-size:0.65rem;font-weight:bold;word-break:break-all;">${ticket.number}</p>
                                            </div>
                                            <div style="background:rgba(255,255,255,0.1);border-radius:10px;padding:10px;text-align:center;">
                                                <p style="font-size:0.6rem;opacity:0.7;text-transform:uppercase;margin-bottom:4px;">Fecha</p>
                                                <p style="font-weight:bold;">21/MAR</p>
                                            </div>
                                            <div style="background:rgba(255,255,255,0.1);border-radius:10px;padding:10px;text-align:center;">
                                                <p style="font-size:0.6rem;opacity:0.7;text-transform:uppercase;margin-bottom:4px;">Hora</p>
                                                <p style="font-weight:bold;">17:00</p>
                                            </div>
                                            <div style="background:rgba(255,255,255,0.1);border-radius:10px;padding:10px;text-align:center;">
                                                <p style="font-size:0.6rem;opacity:0.7;text-transform:uppercase;margin-bottom:4px;">Tipo</p>
                                                <p style="font-weight:bold;">VIP</p>
                                            </div>
                                        </div>
                                        <div style="text-align:center;padding:12px;background:rgba(255,255,255,0.1);border-radius:10px;margin-bottom:12px;">
                                            <p style="font-size:0.75rem;opacity:0.7;margin-bottom:4px;">üìç ${ticket.location}</p>
                                            <p style="font-size:0.75rem;opacity:0.6;">${ticket.city}</p>
                                        </div>
                                        <div style="text-align:center;">
                                            <p style="font-size:0.75rem;opacity:0.6;font-family:monospace;">${ticket.code}</p>
                                            <p style="margin-top:8px;font-size:0.875rem;opacity:0.9;">‚ú¶ ¬°GRACIAS POR CELEBRAR CONMIGO! ‚ú¶</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:20px;">
                                <button onclick="downloadTicketsPDF()" style="background:linear-gradient(135deg,#dc2626,#b91c1c);border:none;color:white;font-weight:bold;padding:12px;border-radius:12px;cursor:pointer;font-size:0.9rem;">üìÑ Descargar PDF</button>
                                <button onclick="downloadTicketsImage()" style="background:linear-gradient(135deg,#2563eb,#1d4ed8);border:none;color:white;font-weight:bold;padding:12px;border-radius:12px;cursor:pointer;font-size:0.9rem;">üñºÔ∏è Descargar Imagen</button>
                                <button onclick="shareTicketWhatsApp()" style="background:linear-gradient(135deg,#16a34a,#15803d);border:none;color:white;font-weight:bold;padding:12px;border-radius:12px;cursor:pointer;font-size:0.9rem;">üí¨ WhatsApp</button>
                                <button onclick="shareOnFacebook()" style="background:linear-gradient(135deg,#1d4ed8,#1e3a8a);border:none;color:white;font-weight:bold;padding:12px;border-radius:12px;cursor:pointer;font-size:0.9rem;">üìò Facebook</button>
                                <button onclick="shareOnTwitter()" style="background:linear-gradient(135deg,#0284c7,#0369a1);border:none;color:white;font-weight:bold;padding:12px;border-radius:12px;cursor:pointer;font-size:0.9rem;">ùïè Twitter</button>
                                <button onclick="window.print()" style="background:linear-gradient(135deg,#7c3aed,#6d28d9);border:none;color:white;font-weight:bold;padding:12px;border-radius:12px;cursor:pointer;font-size:0.9rem;">üñ®Ô∏è Imprimir</button>
                            </div>
                            <button onclick="state.generatedTickets=[];state.guestNames=[''];document.getElementById('modal-container').innerHTML=renderTicketForm();" style="width:100%;margin-top:10px;background:#f3f4f6;border:none;color:#374151;font-weight:bold;padding:14px;border-radius:12px;cursor:pointer;">‚ûï Generar Nuevo</button>
                            <button onclick="closeModal()" style="width:100%;margin-top:8px;background:#f3f4f6;border:none;color:#374151;font-weight:bold;padding:14px;border-radius:12px;cursor:pointer;">Cerrar</button>
                        </div>
                    </div>
                `;
            }
        }

        // Cambiar secci√≥n
        function changeSection(section) {
            state.currentSection = section;
            // Update only the section container
            const sectionEl = document.getElementById('section-content');
            if (sectionEl) sectionEl.innerHTML = renderSection();
            // Update button active states
            ['ceremonia','recepcion','viaje'].forEach(s => {
                const btn = document.getElementById('btn-' + s);
                if (btn) {
                    if (s === section) btn.classList.add('ring-4','ring-pink-300');
                    else btn.classList.remove('ring-4','ring-pink-300');
                }
            });
        }

        // Render principal
        function render() {
            const app = document.getElementById('app');
            const modalContainer = document.getElementById('modal-container');

            if (!state.opened) {
                if (!state._envelopeRendered) {
                    state._envelopeRendered = true;
                    app.innerHTML = `
                        <div class="min-h-screen flex flex-col items-center justify-center p-4">
                            <div class="text-center mb-12 animate-fadeIn">
                                <h1 id="titulo-principal" class="text-5xl md:text-7xl font-bold text-pink-600 mb-4 cursive min-h-[80px]"></h1>
                                <p id="subtitulo" class="text-xl md:text-2xl text-gray-600 min-h-[40px]"></p>
                            </div>
                            <div class="envelope" id="envelope" onclick="openEnvelope()">
                                <div class="envelope-back"></div>
                                <div class="envelope-front"></div>
                                <div class="envelope-top"></div>
                                <div class="seal">üåπ</div>
                                <div class="letter"></div>
                            </div>
                            <div class="mt-12 text-center max-w-2xl animate-slideUp" style="animation-delay: 0.5s;">
                                <p id="mensaje-inicial" class="text-gray-500 text-lg italic leading-relaxed font-light min-h-[80px]"></p>
                            </div>
                        </div>
                    `;
                    setTimeout(() => {
                        typeText('titulo-principal', 'XV A√±os', 100, () => {
                            typeText('subtitulo', 'Toca el sobre para abrir tu invitaci√≥n', 50, () => {
                                typeText('mensaje-inicial', '"Un d√≠a especial, un momento m√°gico, donde celebramos toda una vida de crecimiento, sue√±os y promesas por cumplir."', 25);
                            });
                        });
                    }, 400);
                }
            } else if (!state._contentRendered) {
                state._contentRendered = true;
                app.innerHTML = `
                    <div class="min-h-screen py-12 px-4">
                        <div class="max-w-4xl mx-auto">
                            ${renderContent()}
                        </div>
                    </div>
                `;
            }

            // Modales en contenedor separado ‚Äî no tocan el DOM del contenido principal
            if (state.showTimeline) {
                modalContainer.innerHTML = renderTimeline();
            } else if (state.showQR) {
                modalContainer.innerHTML = renderQRModal();
                setTimeout(() => {
                    const url = state.qrType === 'parroquia' ?
                        eventData.ceremonia.mapsUrl : eventData.recepcion.mapsUrl;
                    generateQRCode(url, 'qrCode');
                }, 100);
            } else if (state.showTicketGenerator) {
                modalContainer.innerHTML = renderTicketForm();
            } else {
                modalContainer.innerHTML = '';
            }
        }

        // Renderizar contenido principal
        function renderContent() {
            return `
                <div class="bg-gradient-to-br from-pink-50 to-purple-50 border border-pink-200 rounded-3xl shadow-xl p-8 md:p-12 mb-8 animate-fadeIn">
                    <p id="frase-magica" class="text-center text-gray-700 text-xl leading-relaxed font-light italic min-h-[100px]"></p>
                </div>

                <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12 mb-8 animate-fadeIn">
                    <div class="text-center mb-8">
                        <div class="w-48 h-48 mx-auto mb-6 rounded-full overflow-hidden border-8 border-pink-200 shadow-xl">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23ec4899;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23a855f7;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='200' height='200' fill='url(%23grad)'/%3E%3Ctext x='100' y='120' font-size='100' text-anchor='middle' fill='white' font-family='serif'%3Eüë∏%3C/text%3E%3C/svg%3E" 
                                 alt="Quincea√±era" class="w-full h-full object-cover">
                        </div>

                        <p id="invitacion-label" class="text-sm tracking-[0.3em] text-pink-400 uppercase font-light mb-2 min-h-[20px]"></p>
                        <p id="padres-nombres" class="text-xl text-gray-500 font-light tracking-wider mb-4 min-h-[30px]"></p>
                        
                        <div class="mb-4">
                            <h2 id="nombre-principal" class="text-5xl md:text-6xl font-bold text-transparent bg-gradient-to-r from-pink-500 via-purple-500 to-pink-500 bg-clip-text cursive min-h-[80px]"></h2>
                        </div>
                        
                        <div class="mb-6">
                            <h3 id="apellido-principal" class="text-3xl md:text-4xl text-gray-700 font-light min-h-[50px]"></h3>
                        </div>
                        
                        <div class="text-7xl mb-4">üëë</div>
                        <p class="text-xl text-pink-600 font-semibold mb-2">${eventData.quincea√±era.edad} A√±os</p>
                    </div>
                </div>

                <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12 mb-8 animate-fadeIn" style="animation-delay: 0.2s;">
                    <div class="text-center">
                        <p class="text-gray-600 text-lg mb-4">
                            ${eventData.padres.nombres} tenemos el gusto de invitarte a compartir ese d√≠a tan especial, para celebrar con nuestra hija su cumplea√±os.
                        </p>
                    </div>
                </div>

                <div class="grid grid-cols-4 gap-3 mb-8 animate-slideUp">
                    <button id="btn-viaje" onclick="toggleTimeline()" 
                            class="elegant-button text-white font-bold py-4 px-3 rounded-2xl transition transform hover:scale-105">
                        <div class="text-2xl mb-1">üìñ</div>
                        <div class="text-xs">Mi Viaje</div>
                    </button>
                    <button id="btn-ceremonia" onclick="changeSection('ceremonia')" 
                            class="elegant-button text-white font-bold py-4 px-3 rounded-2xl transition transform hover:scale-105 ${state.currentSection === 'ceremonia' ? 'ring-4 ring-pink-300' : ''}">
                        <div class="text-2xl mb-1">‚õ™</div>
                        <div class="text-xs">Ceremonia</div>
                    </button>
                    <button id="btn-recepcion" onclick="changeSection('recepcion')" 
                            class="elegant-button text-white font-bold py-4 px-3 rounded-2xl transition transform hover:scale-105 ${state.currentSection === 'recepcion' ? 'ring-4 ring-pink-300' : ''}">
                        <div class="text-2xl mb-1">üéâ</div>
                        <div class="text-xs">Recepci√≥n</div>
                    </button>
                    <button onclick="toggleTicket()" 
                            class="elegant-button text-white font-bold py-4 px-3 rounded-2xl transition transform hover:scale-105">
                        <div class="text-2xl mb-1">üé´</div>
                        <div class="text-xs">Boletos</div>
                    </button>
                </div>

                <div id="section-content">${renderSection()}</div>

                <div class="bg-gradient-to-br from-pink-100 to-purple-100 rounded-3xl p-8 mt-8 text-center animate-fadeIn">
                    <p class="text-xl text-gray-700 mb-2 font-semibold">Con amor y alegr√≠a te esperamos üíï</p>
                    <p class="text-gray-600 mb-6">Por favor confirma tu asistencia</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <button onclick="shareWhatsApp()" 
                                class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-4 px-6 rounded-2xl transition transform hover:scale-105 flex items-center justify-center gap-2 shadow-xl">
                            <span class="text-xl">üí¨</span><span>WhatsApp</span>
                        </button>
                        <button onclick="shareOnFacebook()" 
                                class="bg-gradient-to-r from-blue-700 to-blue-800 hover:from-blue-800 hover:to-blue-900 text-white font-bold py-4 px-6 rounded-2xl transition transform hover:scale-105 flex items-center justify-center gap-2 shadow-xl">
                            <span class="text-xl">üìò</span><span>Facebook</span>
                        </button>
                        <button onclick="shareOnTwitter()" 
                                class="bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white font-bold py-4 px-6 rounded-2xl transition transform hover:scale-105 flex items-center justify-center gap-2 shadow-xl">
                            <span class="text-xl">ùïè</span><span>Twitter</span>
                        </button>
                    </div>
                    <div class="text-5xl space-x-3 mt-6">üéâ üíï üéä</div>
                </div>
            `;
        }

        function renderSection() {
            if (state.currentSection === 'ceremonia') {
                return `
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12 animate-slideUp">
                        <h3 class="text-4xl font-bold text-center text-pink-600 mb-8 flex items-center justify-center gap-3">
                            <span>‚õ™</span>
                            <span>Ceremonia Religiosa</span>
                        </h3>
                        
                        <div class="space-y-6">
                            <div class="bg-pink-50 rounded-2xl p-6">
                                <h4 class="text-2xl font-bold text-gray-800 mb-3">
                                    ${eventData.ceremonia.nombre}
                                </h4>
                                <p class="text-sm text-gray-600 mb-4">${eventData.ceremonia.nombreCompleto}</p>
                                
                                <div class="space-y-2 text-gray-700">
                                    <p class="flex items-start gap-2">
                                        <span class="text-pink-500">üìç</span>
                                        <span>${eventData.ceremonia.direccion}<br>
                                        ${eventData.ceremonia.colonia}<br>
                                        ${eventData.ceremonia.ciudad}</span>
                                    </p>
                                    
                                    <p class="flex items-center gap-2">
                                        <span class="text-pink-500">üìû</span>
                                        <span>${eventData.ceremonia.telefono}</span>
                                    </p>
                                    
                                    <p class="flex items-center gap-2">
                                        <span class="text-pink-500">üïê</span>
                                        <span class="font-bold text-xl">${eventData.ceremonia.hora}</span>
                                    </p>
                                    
                                    <p class="flex items-center gap-2">
                                        <span class="text-pink-500">üìÖ</span>
                                        <span class="font-semibold">${eventData.ceremonia.fecha}</span>
                                    </p>
                                </div>
                            </div>
                            
                            <button onclick="showQR('parroquia')" 
                                    class="w-full elegant-button text-white font-bold py-4 px-6 rounded-2xl transition transform hover:scale-105 flex items-center justify-center gap-3">
                                <span class="text-2xl">üìç</span>
                                <span>Ver Ubicaci√≥n (C√≥digo QR)</span>
                            </button>
                        </div>
                    </div>
                `;
            } else if (state.currentSection === 'recepcion') {
                return `
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12 animate-slideUp">
                        <h3 class="text-4xl font-bold text-center text-pink-600 mb-8 flex items-center justify-center gap-3">
                            <span>üéâ</span>
                            <span>Recepci√≥n</span>
                        </h3>
                        
                        <div class="space-y-6">
                            <div class="bg-purple-50 rounded-2xl p-6">
                                <h4 class="text-2xl font-bold text-gray-800 mb-3">
                                    ${eventData.recepcion.nombre}
                                </h4>
                                
                                <div class="space-y-2 text-gray-700">
                                    <p class="flex items-start gap-2">
                                        <span class="text-purple-500">üìç</span>
                                        <span>${eventData.recepcion.direccion}<br>
                                        ${eventData.recepcion.referencia}<br>
                                        ${eventData.recepcion.colonia}<br>
                                        ${eventData.recepcion.ciudad}</span>
                                    </p>
                                    
                                    <p class="flex items-center gap-2">
                                        <span class="text-purple-500">üïê</span>
                                        <span class="font-bold text-xl">${eventData.recepcion.hora}</span>
                                    </p>
                                </div>
                                
                                <div class="mt-6 p-4 bg-white rounded-xl border-2 border-purple-200">
                                    <p class="text-center text-purple-600 font-semibold italic">
                                        ¬°Nos alegra mucho que compartas!
                                    </p>
                                </div>
                            </div>
                            
                            <button onclick="showQR('recepcion')" 
                                    class="w-full elegant-button text-white font-bold py-4 px-6 rounded-2xl transition transform hover:scale-105 flex items-center justify-center gap-3">
                                <span class="text-2xl">üìç</span>
                                <span>Ver Ubicaci√≥n (C√≥digo QR)</span>
                            </button>
                        </div>
                    </div>
                `;
            } else if (state.currentSection === 'boleto') {
                return `
                    <div class="bg-white rounded-3xl shadow-2xl p-8 md:p-12 animate-slideUp">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üé´</div>
                            <p class="text-gray-600 text-lg">Haz clic en el bot√≥n <strong>Boletos</strong> para generar tu boleto VIP personalizado.</p>
                        </div>
                    </div>
                `;
            }
            
            return '';
        }

        function renderQRModal() {
            const data = state.qrType === 'parroquia' ? eventData.ceremonia : eventData.recepcion;
            const title = state.qrType === 'parroquia' ? 'Ubicaci√≥n de la Ceremonia' : 'Ubicaci√≥n de la Recepci√≥n';
            const icon = state.qrType === 'parroquia' ? '‚õ™' : 'üéâ';
            
            return `
                <div class="qr-modal" onclick="if(event.target === this) closeModal()">
                    <div class="qr-content max-w-md">
                        <div class="text-center">
                            <h3 class="text-3xl font-bold text-pink-600 mb-4 flex items-center justify-center gap-3">
                                <span>${icon}</span>
                                <span>${title}</span>
                            </h3>
                            
                            <div class="bg-gray-100 rounded-2xl p-6 mb-6">
                                <div id="qrCode" class="flex justify-center mb-4"></div>
                                
                                <div class="text-left space-y-2 text-gray-700">
                                    <p class="font-bold">${data.nombre}</p>
                                    ${data.direccion ? `<p>${data.direccion}</p>` : ''}
                                    ${data.referencia ? `<p class="text-sm text-gray-600">${data.referencia}</p>` : ''}
                                    ${data.colonia ? `<p>${data.colonia}</p>` : ''}
                                    ${data.ciudad ? `<p>${data.ciudad}</p>` : ''}
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <a href="${data.mapsUrl}" 
                                   target="_blank"
                                   class="block w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-2xl transition">
                                    Abrir en Google Maps
                                </a>
                                
                                <button onclick="closeModal()" 
                                        class="block w-full bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-4 px-6 rounded-2xl transition">
                                    Cerrar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.onload = function() {
            generateBackgroundText();
            render();
        };
    </script>
</body>
</html>
